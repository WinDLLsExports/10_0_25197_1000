Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\WinSxS\amd64_microsoft-windows-winreagent_31bf3856ad364e35_10.0.25197.1000_none_4d5cb95f92598d3c\WinREAgent.dll

File Type: DLL

  Image has the following dependencies:

    msvcrt.dll
    KERNEL32.dll
    USER32.dll
    ReAgent.dll
    OLEAUT32.dll
    api-ms-win-core-libraryloader-l1-2-0.dll
    api-ms-win-core-file-l1-1-0.dll
    api-ms-win-core-sysinfo-l1-1-0.dll
    api-ms-win-core-file-l2-1-0.dll
    CRYPT32.dll
    api-ms-win-core-io-l1-1-0.dll
    ntdll.dll
    WINTRUST.dll
    DismApi.DLL
    WDSCORE.dll
    WIMGAPI.DLL
    ServicingCommon.dll
    ADVAPI32.dll
    ole32.dll
    api-ms-win-core-version-l1-1-0.dll
    RPCRT4.dll
    ktmw32.dll
    bcrypt.dll

  Section contains the following exports for WinREAgent.dll

    00000000 characteristics
    4D9CD32B time date stamp
        0.00 version
           1 ordinal base
           7 number of functions
           7 number of names

    ordinal hint RVA      name

          1    0 00013F10 BackupWinRE
          2    1 00013F20 CreateWinREServicingManager
          3    2 00014110 GetWinREAgentVersion
          4    3 00014140 GetWinREVersion
          5    4 00014650 LoadWinREServicingManager
          6    5 00014800 RestoreWinRE
          7    6 00014810 SaveWinREServicingManager

  Section contains the following imports:

    msvcrt.dll
             18005AB48 Import Address Table
             18007E458 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         4DC strncpy_s
                         4E5 strtol
                         2C9 _set_errno
                         518 wcsncmp
                         50E wcschr
                         397 _wcsicmp
                         4CE strchr
                         4C6 sprintf_s
                         3A1 _wcsnicmp
                          70 __RTDynamicCast
                         412 _wtoi
                         413 _wtoi64
                          14 ??3@YAXPEAX@Z
                         51D wcsrchr
                         49E memcmp
                         10E _errno
                         29C _onexit
                          84 __dllonexit
                         34E _unlock
                         1F2 _lock
                          12 ??1type_info@@UEAA@XZ
                          34 ?terminate@@YAXXZ
                         189 _initterm
                          B7 _amsg_exit
                          5A _XcptFilter
                         4A1 memmove
                         49F memcpy
                          62 __CxxFrameHandler3
                          50 _CxxThrowException
                          36 ?what@exception@@UEBAPEBDXZ
                           B ??0exception@@QEAA@AEBQEBDH@Z
                           A ??0exception@@QEAA@AEBQEBD@Z
                          C8 _callnewh
                         493 malloc
                         512 wcscpy_s
                          23 ??_V@YAXPEAX@Z
                          5E __C_specific_handler
                         432 calloc
                         507 vswprintf_s
                         36D _vscwprintf
                         459 free
                         2AA _purecall
                         4A2 memmove_s
                           C ??0exception@@QEAA@AEBV0@@Z
                           D ??0exception@@QEAA@XZ
                         374 _vsnprintf_s
                         4A0 memcpy_s
                          11 ??1exception@@UEAA@XZ
                         376 _vsnwprintf
                          63 __CxxFrameHandler4
                         416 _wtol
                         4A3 memset

    KERNEL32.dll
             18005A680 Import Address Table
             18007DF90 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         5A8 SetUnhandledExceptionFilter
                         235 GetCurrentProcess
                         5C8 TerminateProcess
                         474 QueryPerformanceCounter
                         30E GetSystemTimeAsFileTime
                         330 GetTickCount
                         54C SetEvent
                         54A SetEnvironmentVariableW
                         3F6 LocalFree
                         1BC FlushFileBuffers
                         556 SetFileInformationByHandle
                         266 GetFileInformationByHandle
                         508 RtlVirtualUnwind
                         501 RtlLookupFunctionEntry
                         4F9 RtlCaptureContext
                         5B8 Sleep
                          AD CompareStringW
                         48B RaiseException
                         389 InitializeCriticalSection
                         373 HeapDestroy
                         377 HeapReAlloc
                         379 HeapSize
                         416 MultiByteToWideChar
                         63B WideCharToMultiByte
                         312 GetSystemWindowsDirectoryW
                         1B2 FindResourceExW
                         3EE LoadResource
                         402 LockResource
                         5B7 SizeofResource
                         3E4 LeaveCriticalSection
                         267 GetFileInformationByHandleEx
                           1 AcquireSRWLockShared
                         4DC ReleaseSRWLockExclusive
                           0 AcquireSRWLockExclusive
                         305 GetSystemDirectoryW
                         12B DeleteFileW
                         553 SetFileAttributesW
                         22E GetCurrentDirectoryW
                         34B GetVolumeNameForVolumeMountPointW
                         270 GetFinalPathNameByHandleW
                          FF CreateSemaphoreExW
                         28E GetLongPathNameW
                         279 GetFullPathNameW
                          CC CreateDirectoryW
                         5EA UnhandledExceptionFilter
                          EC CreateMutexExW
                         236 GetCurrentProcessId
                         247 GetDiskFreeSpaceExW
                         1C8 FreeLibrary
                         10A CreateThreadpoolTimer
                         436 OpenSemaphoreW
                         614 WaitForSingleObject
                         126 DeleteCriticalSection
                         38B InitializeCriticalSectionEx
                         14C EnterCriticalSection
                         615 WaitForSingleObjectEx
                          A2 CloseThreadpoolTimer
                         617 WaitForThreadpoolTimerCallbacks
                         5A1 SetThreadpoolTimer
                         5DD TlsSetValue
                         5DC TlsGetValue
                         5DA TlsAlloc
                         2CB GetPrivateProfileSectionNamesW
                          B9 CopyFile2
                         34F GetVolumePathNamesForVolumeNameW
                         411 MoveFileTransactedW
                          D1 CreateEventW
                         239 GetCurrentThread
                         2CC GetPrivateProfileSectionW
                         655 WritePrivateProfileStringW
                         4D9 ReleaseMutex
                         43E OutputDebugStringW
                         3A4 IsDebuggerPresent
                         281 GetLastError
                         2D1 GetProcAddress
                         299 GetModuleHandleW
                         11C DebugBreak
                         294 GetModuleFileNameA
                         298 GetModuleHandleExW
                         374 HeapFree
                         2D8 GetProcessHeap
                         370 HeapAlloc
                         23A GetCurrentThreadId
                         1C4 FormatMessageW
                         4DE ReleaseSemaphore
                          97 CloseHandle
                         568 SetLastError
                         4DD ReleaseSRWLockShared

    USER32.dll
             18005A9C0 Import Address Table
             18007E2D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         3C1 UnregisterClassA

    ReAgent.dll
             18005A970 Import Address Table
             18007E280 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          16 WinReHashWimFile
                           F WinReGetConfig
                          2E WinReSetupBackupWinRE
                          19 WinReInstallOnTargetOS

    OLEAUT32.dll
             18005A948 Import Address Table
             18007E258 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal     2
                             Ordinal     6

    api-ms-win-core-libraryloader-l1-2-0.dll
             18005AAE0 Import Address Table
             18007E3F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 LoadLibraryExW

    api-ms-win-core-file-l1-1-0.dll
             18005AA88 Import Address Table
             18007E398 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 CreateFileW
                          2D GetFileAttributesW
                          46 GetVolumePathNameW
                           D FindClose
                          15 FindFirstFileW
                          1B FindNextFileW

    api-ms-win-core-sysinfo-l1-1-0.dll
             18005AAF0 Import Address Table
             18007E400 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          20 GetWindowsDirectoryW

    api-ms-win-core-file-l2-1-0.dll
             18005AAC0 Import Address Table
             18007E3D0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           9 MoveFileExW

    CRYPT32.dll
             18005A608 Import Address Table
             18007DF18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          76 CertVerifyCertificateChainPolicy

    api-ms-win-core-io-l1-1-0.dll
             18005AAD0 Import Address Table
             18007E3E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           4 DeviceIoControl

    ntdll.dll
             18005ACF0 Import Address Table
             18007E600 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         5DB RtlSetThreadErrorMode
                         255 NtSetInformationFile
                         2E6 RtlAllocateHeap
                         40F RtlFreeHeap
                         520 RtlNtStatusToDosError

    WINTRUST.dll
             18005AA68 Import Address Table
             18007E378 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          6D WTHelperProvDataFromStateData
                          68 WTHelperGetProvSignerFromChain
                          91 WinVerifyTrust

    DismApi.DLL
             18005A618 Import Address Table
             18007DF28 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 DismCloseSession
                          25 DismShutdown
                          1D DismOpenSession
                          1B DismInitialize
                          26 DismUnmountImage
                          1C DismMountImage
                          16 DismGetPackageInfo
                          18 DismGetPackages
                          29 _DismAddPackageEx
                          31 _DismCleanImage
                          13 DismGetImageInfo
                           9 DismDelete

    WDSCORE.dll
             18005A9D0 Import Address Table
             18007E2E0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           3 ConstructPartialMsgVW
                           4 CurrentIP
                          59 WdsSetupLogMessageW
                          37 WdsInitialize
                          5B WdsTerminate

    WIMGAPI.DLL
             18005AA00 Import Address Table
             18007E310 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A WIMCreateFile
                          3C WIMUnregisterLogFile
                          25 WIMLoadImage
                          3D WIMUnregisterMessageCallback
                           7 WIMCloseHandle
                          36 WIMSetTemporaryPath
                          16 WIMGetAttributes
                          3B WIMUnmountImageHandle
                          3A WIMUnmountImage
                          2E WIMRegisterMessageCallback
                          10 WIMExportImage
                          2D WIMRegisterLogFile

    ServicingCommon.dll
             18005A998 Import Address Table
             18007E2A8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           5 CbsGetSsBinaryPathFromTargetImage
                           2 CbsCreateOfflineSession
                          BD StringsAreEqualCaseInsensitive
                           7 CbsOfflineFinalize

    ADVAPI32.dll
             18005A530 Import Address Table
             18007DE40 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         179 InitializeAcl
                         2D2 SetFileSecurityW
                         130 GetFileSecurityW
                          79 ConvertSecurityDescriptorToStringSecurityDescriptorW
                         114 EventWriteTransfer
                         10D EventSetInformation
                         10C EventRegister
                         10E EventUnregister
                          85 CopySid
                         210 OpenThreadToken
                         15B GetTokenInformation
                         19A LookupPrivilegeValueW
                         2DE SetSecurityDescriptorDacl
                          1F AdjustTokenPrivileges
                         2E0 SetSecurityDescriptorOwner
                         122 GetAce
                          20 AllocateAndInitializeSid
                         20B OpenProcessToken
                         11F FreeSid
                         17A InitializeSecurityDescriptor
                         136 GetLengthSid
                         2DD SetSecurityDescriptorControl
                          10 AddAccessAllowedAce
                         1F5 MakeSelfRelativeSD
                         2DF SetSecurityDescriptorGroup
                          81 ConvertStringSecurityDescriptorToSecurityDescriptorW

    ole32.dll
             18005AD20 Import Address Table
             18007E630 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         20D StringFromGUID2
                          2B CoCreateInstance
                          8C CoTaskMemFree
                          51 CoGetMalloc

    api-ms-win-core-version-l1-1-0.dll
             18005AB00 Import Address Table
             18007E410 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 GetFileVersionInfoExW
                           5 VerQueryValueW
                           1 GetFileVersionInfoSizeExW

    RPCRT4.dll
             18005A960 Import Address Table
             18007E270 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         21E UuidCreate

    ktmw32.dll
             18005AB30 Import Address Table
             18007E440 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 CommitTransaction
                           6 CreateTransaction

    bcrypt.dll
             18005AB20 Import Address Table
             18007E430 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           2 BCryptCloseAlgorithmProvider

  Summary

        3000 .data
        4000 .pdata
       29000 .rdata
        1000 .reloc
        1000 .rsrc
       56000 .text
