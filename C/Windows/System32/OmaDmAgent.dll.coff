Microsoft (R) COFF/PE Dumper Version 14.29.30137.0
Copyright (C) Microsoft Corporation.  All rights reserved.


Dump of file C:\Windows\System32\OmaDmAgent.dll

File Type: DLL

  Image has the following dependencies:

    msvcp110_win.dll
    msvcrt.dll
    ADVAPI32.dll
    KERNEL32.dll
    ole32.dll
    WTSAPI32.dll
    DMCmnUtils.dll
    omadmapi.dll
    dmEnrollEngine.DLL
    MDMRegistration.DLL
    mi.dll
    OLEAUT32.dll
    RPCRT4.dll
    SHELL32.dll
    SHLWAPI.dll
    sppc.dll
    urlmon.dll
    WSClient.dll
    api-ms-win-core-winrt-l1-1-0.dll
    api-ms-win-core-winrt-string-l1-1-0.dll

  Section contains the following exports for omadmagent.dll

    00000000 characteristics
    E84FEFF1 time date stamp
        0.00 version
           1 ordinal base
           2 number of functions
           2 number of names

    ordinal hint RVA      name

          1    0 00004680 OmaDmRunPostSessionWork
          2    1 00006DC0 ResourceManagerUninstallWmiApp

  Section contains the following imports:

    msvcp110_win.dll
             180022810 Import Address Table
             1800287F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         283 ?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UEAAXXZ
                         23A ?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UEAAXXZ
                         3C8 ?id@?$codecvt@DDH@std@@2V0locale@2@A
                         12D ??Bid@locale@std@@QEAA_KXZ
                         1E8 ?_Getgloballocale@locale@std@@CAPEAV_Locimp@12@XZ
                          6A ??0_Lockit@std@@QEAA@H@Z
                          A2 ??1_Lockit@std@@QEAA@XZ
                         1BF ?_Fiopen@std@@YAPEAU_iobuf@@PEBGHH@Z
                         4D4 ?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAA_JXZ
                         4C4 ?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QEAAXH_N@Z
                           7 ??0?$basic_ios@DU?$char_traits@D@std@@@std@@IEAA@XZ
                          7F ??1?$basic_istream@DU?$char_traits@D@std@@@std@@UEAA@XZ
                          85 ??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UEAA@XZ
                         254 ?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAPEADXZ
                         446 ?pptr@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEBAPEADXZ
                         1FC ?_Gninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAPEADXZ
                         3C5 ?gptr@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEBAPEADXZ
                         1AE ?_BADOFF@std@@3_JB
                          79 ??1?$basic_ios@DU?$char_traits@D@std@@@std@@UEAA@XZ
                         276 ?_Swap_all@_Container_base0@std@@QEAAXAEAU12@@Z
                         545 ?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAA_JPEAD_J@Z
                         548 ?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MEAA_JPEBD_J@Z
                         1A4 ?_Add_vtordisp2@?$basic_ios@DU?$char_traits@D@std@@@std@@UEAAXXZ
                         1A1 ?_Add_vtordisp1@?$basic_istream@DU?$char_traits@D@std@@@std@@UEAAXXZ
                         1C4 ?_Getcat@?$codecvt@DDH@std@@SA_KPEAPEBVfacet@locale@2@PEBV42@@Z
                         526 ?unshift@?$codecvt@DDH@std@@QEBAHAEAHPEAD1AEAPEAD@Z
                          2A ??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAA@XZ
                         3BF ?getloc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QEBA?AVlocale@2@XZ
                          15 ??0?$basic_istream@DU?$char_traits@D@std@@@std@@QEAA@PEAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z
                         1F9 ?_Gndec@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAPEADXZ
                         355 ?epptr@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEBAPEADXZ
                         348 ?egptr@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEBAPEADXZ
                         345 ?eback@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEBAPEADXZ
                         432 ?out@?$codecvt@DDH@std@@QEBAHAEAHPEBD1AEAPEBDPEAD3AEAPEAD@Z
                         3F9 ?in@?$codecvt@DDH@std@@QEBAHAEAHPEBD1AEAPEBDPEAD3AEAPEAD@Z
                         208 ?_Init@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAXPEAPEAD0PEAH001@Z
                         209 ?_Init@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAXXZ
                         296 ?always_noconv@codecvt_base@std@@QEBA_NXZ
                         4B9 ?setg@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IEAAXPEAD00@Z
                         279 ?_Syserror_map@std@@YAPEBDH@Z
                         290 ?_Xlength_error@std@@YAXPEBD@Z
                         289 ?_Winerror_map@std@@YAPEBDH@Z
                         291 ?_Xout_of_range@std@@YAXPEBD@Z
                         3C4 ?good@ios_base@std@@QEBA_NXZ
                         28D ?_Xbad_alloc@std@@YAXXZ

    msvcrt.dll
             180022980 Import Address Table
             180028968 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         518 wcsncmp
                           7 ??0bad_cast@@QEAA@PEBD@Z
                           F ??1bad_cast@@UEAA@XZ
                           6 ??0bad_cast@@QEAA@AEBV0@@Z
                         443 fclose
                         464 fwrite
                         448 fgetpos
                         141 _fseeki64
                         460 fsetpos
                         4BF setvbuf
                         446 fflush
                         4FA ungetc
                         454 fputc
                         447 fgetc
                         3A1 _wcsnicmp
                         525 wcstol
                         528 wcstoul
                         4F8 towlower
                         4B6 realloc
                         412 _wtoi
                         2E3 _snwprintf_s
                         4F7 toupper
                          50 _CxxThrowException
                         512 wcscpy_s
                         4A1 memmove
                         4A3 memset
                          12 ??1type_info@@UEAA@XZ
                         29C _onexit
                          84 __dllonexit
                         34E _unlock
                         1F2 _lock
                          34 ?terminate@@YAXXZ
                          5E __C_specific_handler
                         189 _initterm
                         459 free
                          B7 _amsg_exit
                          5A _XcptFilter
                          C8 _callnewh
                         493 malloc
                         374 _vsnprintf_s
                           C ??0exception@@QEAA@AEBV0@@Z
                           D ??0exception@@QEAA@XZ
                          11 ??1exception@@UEAA@XZ
                         2AA _purecall
                          14 ??3@YAXPEAX@Z
                         397 _wcsicmp
                         4A0 memcpy_s
                         376 _vsnwprintf
                          23 ??_V@YAXPEAX@Z
                          63 __CxxFrameHandler4
                         49F memcpy
                          62 __CxxFrameHandler3
                         50F wcscmp

    ADVAPI32.dll
             180022410 Import Address Table
             1800283F8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         282 RegOpenKeyExW
                          5F CheckTokenMembership
                         114 EventWriteTransfer
                          8B CreateProcessAsUserW
                         277 RegGetValueW
                         2B7 RevertToSelf
                         273 RegEnumValueW
                         269 RegDeleteValueW
                         289 RegQueryInfoKeyW
                         27F RegOpenCurrentUser
                         176 ImpersonateLoggedOnUser
                         28F RegQueryValueExW
                         251 RegCloseKey
                         25A RegCreateKeyExW
                         29F RegSetValueExW
                         15B GetTokenInformation
                         136 GetLengthSid
                          85 CopySid
                         210 OpenThreadToken
                         20B OpenProcessToken
                          7B ConvertSidToStringSidW
                         270 RegEnumKeyExW
                         260 RegDeleteKeyExW
                         10C EventRegister
                         10D EventSetInformation
                         10E EventUnregister
                         31E TraceMessage

    KERNEL32.dll
             180022528 Import Address Table
             180028510 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         281 GetLastError
                         43E OutputDebugStringW
                         568 SetLastError
                         436 OpenSemaphoreW
                          97 CloseHandle
                         370 HeapAlloc
                         2D1 GetProcAddress
                          EC CreateMutexExW
                         3F6 LocalFree
                         60E WTSGetActiveConsoleSessionId
                         236 GetCurrentProcessId
                         2D8 GetProcessHeap
                         299 GetModuleHandleW
                         11C DebugBreak
                         3A4 IsDebuggerPresent
                         1C4 FormatMessageW
                         4F9 RtlCaptureContext
                         501 RtlLookupFunctionEntry
                         508 RtlVirtualUnwind
                         5EA UnhandledExceptionFilter
                         5A8 SetUnhandledExceptionFilter
                         235 GetCurrentProcess
                         5C8 TerminateProcess
                         474 QueryPerformanceCounter
                         30E GetSystemTimeAsFileTime
                         330 GetTickCount
                         374 HeapFree
                          FF CreateSemaphoreExW
                         294 GetModuleFileNameA
                         137 DisableThreadLibraryCalls
                         305 GetSystemDirectoryW
                         63B WideCharToMultiByte
                         4D9 ReleaseMutex
                         23A GetCurrentThreadId
                         3F1 LocalAlloc
                         614 WaitForSingleObject
                         298 GetModuleHandleExW
                         5B8 Sleep
                         4DE ReleaseSemaphore
                         239 GetCurrentThread
                         106 CreateThread
                         14C EnterCriticalSection
                         3E4 LeaveCriticalSection
                         389 InitializeCriticalSection
                         126 DeleteCriticalSection
                         12B DeleteFileW
                         48B RaiseException
                          DD CreateFileW
                         64F WriteFile
                         17F ExpandEnvironmentStringsW
                         54C SetEvent
                         615 WaitForSingleObjectEx
                          D1 CreateEventW

    ole32.dll
             180022B30 Import Address Table
             180028B18 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          61 CoInitializeEx
                          10 CLSIDFromString
                          91 CoUninitialize
                          2A CoCreateGuid
                         20D StringFromGUID2
                          8C CoTaskMemFree
                          2B CoCreateInstance
                          87 CoSetProxyBlanket

    WTSAPI32.dll
             180022780 Import Address Table
             180028768 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          29 WTSQueryUserToken

    DMCmnUtils.dll
             1800224F0 Import Address Table
             1800284D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          19 DmGetActiveUserSid
                          40 DmRevertToSelf
                          2A DmImpersonate
                          29 DmGetUserTokenFromSid
                          1B DmGetCurrentUserSid
                          6C OmaDmRegistryGetDWORD

    omadmapi.dll
             180022B78 Import Address Table
             180028B60 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal    34
                             Ordinal    44

    dmEnrollEngine.DLL
             1800227E0 Import Address Table
             1800287C8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1F GetEnrollmentSID
                          22 GetEnrollmentType
                          25 GetFirstEnrollmentGuidOfTypes

    MDMRegistration.DLL
             1800226D8 Import Address Table
             1800286C0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          10 UnregisterDeviceWithManagement
                           6 IsDeviceRegisteredWithManagement

    mi.dll
             180022800 Import Address Table
             1800287E8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           0 MI_Application_InitializeV1

    OLEAUT32.dll
             1800226F0 Import Address Table
             1800286D8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                             Ordinal     6
                             Ordinal     2

    RPCRT4.dll
             180022708 Import Address Table
             1800286F0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         227 UuidToStringW
                         215 RpcStringFreeW
                         223 UuidFromStringW

    SHELL32.dll
             180022728 Import Address Table
             180028710 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         16E SHGetSpecialFolderPathW
                          9D SHCreateDirectoryExW
                         150 SHGetFolderPathW

    SHLWAPI.dll
             180022748 Import Address Table
             180028730 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                         175 UrlUnescapeW
                          AE SHCreateStreamOnFileEx

    sppc.dll
             180022B90 Import Address Table
             180028B78 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          1C SLGetSLIDList
                           1 SLClose
                          23 SLOpen
                          16 SLGetLicensingStatusInformation
                          1B SLGetProductSkuInformation

    urlmon.dll
             180022BC0 Import Address Table
             180028BA8 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          5C IsValidURL

    WSClient.dll
             180022760 Import Address Table
             180028748 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                          15 WSLicenseOpen
                          14 WSLicenseInstallLicense
                           A WSLicenseClose

    api-ms-win-core-winrt-l1-1-0.dll
             180022790 Import Address Table
             180028778 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           7 RoUninitialize
                           1 RoGetActivationFactory
                           0 RoActivateInstance
                           3 RoInitialize

    api-ms-win-core-winrt-string-l1-1-0.dll
             1800227B8 Import Address Table
             1800287A0 Import Name Table
                     0 time date stamp
                     0 Index of first forwarder reference

                           A WindowsCreateString
                           C WindowsDeleteString
                          10 WindowsGetStringRawBuffer
                           B WindowsCreateStringReference

  Summary

        1000 .data
        2000 .pdata
        9000 .rdata
        1000 .reloc
        1000 .rsrc
       21000 .text
